#include <tunables/global>

profile docker-tor-hardened-rust flags=(attach_disconnected,mediate_deleted) {
  #include <abstractions/base>
  #include <abstractions/nameservice>

  # Executable
  /torrust rmix,

  # TLS trust roots
  /etc/ssl/certs/** r,
  /usr/share/ca-certificates/** r,

  # Minimal proc access
  @{PROC}/sys/kernel/random/uuid r,
  @{PROC}/sys/kernel/osrelease r,
  @{PROC}/meminfo r,
  /proc/1/cgroup r,

  # Network
  network inet tcp,
  network inet udp,
  deny network raw,

  # Capability
  capability ipc_lock,

  # Tor state (NO creation allowed)
  /var/lib/tor/ rw,
  /var/lib/tor/** rwk,

  # Temp
  /tmp/** rwk,

  # Default deny
  deny /** w,
}
