#include <tunables/global>

profile docker-tor-hardened-rust flags=(attach_disconnected,mediate_deleted) {

  # REQUIRED base permissions
  #include <abstractions/base>
  #include <abstractions/nameservice>

  # Executable
  /torrust rmix,

  # TLS trust roots
  /etc/ssl/certs/** r,
  /usr/share/ca-certificates/** r,

  # Networking
  network inet tcp,
  network inet udp,
  deny network raw,

  # Capabilities
  capability ipc_lock,

  # Tor state (pre-created, tmpfs)
  /var/lib/tor/ rw,
  /var/lib/tor/** rwk,

  # Temp
  /tmp/** rwk,

  # Silence container probe noise (optional)
  /proc/1/cgroup r,

  # Default deny
  deny /** w,
}
